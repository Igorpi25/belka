type Project
  @model(queries: { list: "listProjects" }, mutations: { create: "createProject", update: "updateProject", delete: "deleteProject" }, subscriptions: { level: OFF })
  @versioned
  @auth(rules: [
    { allow: owner },
    { allow: owner, ownerField: "team" },
    # { allow: owner, ownerField: "freelancers", operations: [create] }
    # {allow: groups, groups: ["Managers"], queries: null, mutations: [create, update, delete]},
    # {allow: groups, groups: ["Employees"], queries: [get, list], mutations: null}
  ])
{
  id: ID!
  owner: String
  team: [String!]
  managers: [String!]
  accauntants: [String!]
  warehousemans: [String!]
  freelancers: [String!]
  name: String
  description: String
  client: String
  status: ProjectStatus
  spec: Spec @connection
  createdAt: String
	updatedAt: String
}

enum ProjectStatus {
  CREATED
  IN_PROGRESS
  COMPLETED
  DELETED
  ARCHIVED
}

type Spec
  @model(queries: { get: "getSpec" }, mutations: { create: "createSpec" }, subscriptions: null)
  @versioned
  @auth(rules: [
    { allow: owner },
    { allow: owner, ownerField: "team" },
  ])
{
  id: ID!
  owner: String
  team: [String]
  waybills: [Waybill!] @connection(name: "SpecWaybills")
}

type Waybill
  @model(queries: { get: "getWaybill" }, mutations: { create: "createWaybill", update: "updateWaybill", delete: "deleteWaybill" }, subscriptions: { level: OFF })
  @versioned
  @auth(rules: [
    { allow: owner },
    { allow: owner, ownerField: "team" },
  ])
{
  id: ID!
  owner: String
  team: [String!]
  number: String
  description: String
  contractor: String
  purchaseDate: String
  deliveryDate: String
  spec: Spec @connection(name: "SpecWaybills")
  waybillSpecId: ID
  products: [Product!] @connection(name: "WaybillProducts")
  status: WaybillStatus
  createdAt: String
	updatedAt: String
}

enum WaybillStatus {
  CREATED
  IN_PRODUCTION
  IN_PROCESSING
  IN_STOCK
  DELETED
  ARCHIVED
}

type Product
  @model(queries: null, mutations: { create: "createProduct", update: "updateProduct", delete: "deleteProduct" }, subscriptions: { level: OFF })
  @versioned
  @auth(rules: [
    { allow: owner },
    { allow: owner, ownerField: "team" },
  ])
{
  id: ID!
  owner: String
  team: [String!]
  article: String
  name: String
  quantity: Int
  # TODO add connection with type ProductUnit, array in project
  unit: String
  costs: ProductCost @connection(name: "ProductCost")
  store: ProductStore @connection(name: "ProductStore")
  info: ProductInfo @connection(name: "ProductInfo")
  link: ProductLink @connection(name: "ProductLink")
  status: ProductStatus
  waybill: Waybill @connection(name: "WaybillProducts")
  productWaybillId: ID
  createdAt: String
	updatedAt: String
}

enum ProductStatus {
  CREATED
  IN_PRODUCTION
  IN_PROCESSING
  IN_STOCK
  DELETED
  ARCHIVED
}

type ProductCost
  @model(queries: null, mutations: { create: "createProductCost", update: "updateProductCost" }, subscriptions: { level: OFF })
  @versioned
  @auth(rules: [
    { allow: owner },
    { allow: owner, ownerField: "team" },
  ])
{
  id: ID!
  owner: String
  team: [String!]
  purchasePrice: Float
  clientPrice: Float
  price: Float
  amount: Float
  total: Float
  product: Product @connection(name: "ProductCost", keyField: "productId")
  productId: ID
}

type ProductStore
  @model(queries: null, mutations: { create: "createProductStore", update: "updateProductStore" }, subscriptions: { level: OFF })
  @versioned
  @auth(rules: [
    { allow: owner },
    { allow: owner, ownerField: "team" },
  ])
{
  id: ID!
  owner: String
  team: [String!]
  net: Float
  gross: Float
  width: Float
  height: Float
  length: Float
  inStock: Boolean
  dimension: Float
  # TODO add connection with type CargoPlace, @model
  cargoPlaceNumber: Int
  product: Product @connection(name: "ProductStore", keyField: "productId")
  productId: ID
}

type ProductInfo
  @model(queries: null, mutations: { create: "createProductInfo", update: "updateProductInfo" }, subscriptions: { level: OFF })
  @versioned
  @auth(rules: [
    { allow: owner },
    { allow: owner, ownerField: "team" },
  ])
{
  id: ID!
  owner: String
  team: [String!]
  images: [String]
  description: String
  product: Product @connection(name: "ProductInfo", keyField: "productId")
  productId: ID
}

type ProductLink
  @model(queries: null, mutations: { create: "createProductLink", update: "updateProductLink" }, subscriptions: { level: OFF })
  @versioned
  @auth(rules: [
    { allow: owner },
    { allow: owner, ownerField: "team" },
  ])
{
  id: ID!
  owner: String
  team: [String!]
  url: String
  product: Product @connection(name: "ProductLink", keyField: "productId")
  productId: ID
}

type Subscription {
  onCreateProject(owner: ID!): Project @aws_subscribe(mutations: ["createProject"])
  onUpdateProject(owner: ID!): Project @aws_subscribe(mutations: ["updateProject"])
  onDeleteProject(owner: ID!): Project @aws_subscribe(mutations: ["deleteProject"])
  onCreateWaybill(owner: ID!, waybillSpecId: ID!): Waybill @aws_subscribe(mutations: ["createWaybill"])
  onUpdateWaybill(owner: ID!, waybillSpecId: ID!): Waybill @aws_subscribe(mutations: ["updateWaybill"])
  onDeleteWaybill(owner: ID!, waybillSpecId: ID!): Waybill @aws_subscribe(mutations: ["deleteWaybill"])
  onCreateProduct(owner: ID!, productWaybillId: ID!): Product @aws_subscribe(mutations: ["createProduct"])
  onUpdateProduct(owner: ID!, productWaybillId: ID!): Product @aws_subscribe(mutations: ["updateProduct"])
  onDeleteProduct(owner: ID!, productWaybillId: ID!): Product @aws_subscribe(mutations: ["deleteProduct"])
  onUpdateProductCost(owner: ID!, productId: ID!): ProductCost @aws_subscribe(mutations: ["updateProductCost"])
  onUpdateProductStore(owner: ID!, productId: ID!): ProductStore @aws_subscribe(mutations: ["updateProductStore"])
  onUpdateProductInfo(owner: ID!, productId: ID!): ProductInfo @aws_subscribe(mutations: ["updateProductInfo"])
  onUpdateProductLink(owner: ID!, productId: ID!): ProductLink @aws_subscribe(mutations: ["updateProductLink"])
}